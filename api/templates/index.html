<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dishcovery - Recipe Search</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="/static/htmx.min.js"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
</head>

<body class="cds-layout">
    <!-- Fixed Header -->
    <header class="cds-header">
        <!-- Mobile Menu Button (hidden on desktop) -->
        <button class="cds-header__menu-trigger" aria-label="Open menu">
            <iconify-icon icon="carbon:menu"></iconify-icon>
        </button>

        <!-- App Title -->
        <h1 class="cds-header__title">
            <iconify-icon icon="carbon:restaurant"></iconify-icon>
            Dishcovery
        </h1>

        <!-- Search Bar -->
        <div class="cds-header__search">
            <form class="cds-search" hx-post="/search" hx-target="#search-results"
                hx-trigger="keyup changed delay:300ms from:input[name=query]">
                <div class="cds-search__input-wrapper">
                    <iconify-icon icon="carbon:search" class="cds-search__icon"></iconify-icon>
                    <input type="text" name="query" class="cds-search__input" placeholder="Search recipes..."
                        autocomplete="off">
                    <button type="button" class="cds-search__clear" aria-label="Clear search">
                        <iconify-icon icon="carbon:close"></iconify-icon>
                    </button>
                </div>
                <input type="hidden" name="size" value="10">
            </form>
        </div>
    </header>

    <!-- Content Area with Sidebar and Main -->
    <div class="cds-content">
        <!-- Left Sidebar -->
        <aside class="cds-sidebar">
            <section>
                <h3>Filters</h3>
                <p>Filter options will be implemented here</p>
            </section>

            <section>
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="/health">
                            <iconify-icon icon="carbon:status-resolved"></iconify-icon>
                            Health Check
                        </a></li>
                    <li><a href="/metrics">
                            <iconify-icon icon="carbon:analytics"></iconify-icon>
                            Metrics
                        </a></li>
                </ul>
            </section>
        </aside>

        <!-- Sidebar Overlay for Mobile -->
        <div class="cds-sidebar-overlay"></div>

        <!-- Main Content -->
        <main class="cds-main">
            <section>
                <h2>Welcome to Dishcovery</h2>
                <p>Search through 62,000+ recipes powered by Elasticsearch</p>
                <p>API Version: {{ version }}</p>
            </section>

            <!-- Search Results Area -->
            <div id="search-results"></div>

            <section>
                <h3>API Endpoints</h3>
                <ul>
                    <li>POST /search - Recipe Search</li>
                    <li>POST /bulk-load - Bulk Load Recipes</li>
                </ul>
                <p>Ready for HTMX-powered dynamic interactions!</p>
            </section>
        </main>
    </div>

    <script>
        // Search functionality
        document.addEventListener('DOMContentLoaded', function () {
            const searchInput = document.querySelector('.cds-search__input');
            const clearButton = document.querySelector('.cds-search__clear');
            const menuTrigger = document.querySelector('.cds-header__menu-trigger');
            const sidebar = document.querySelector('.cds-sidebar');
            const sidebarOverlay = document.querySelector('.cds-sidebar-overlay');

            // Clear button functionality
            if (searchInput && clearButton) {
                // Show/hide clear button based on input content
                searchInput.addEventListener('input', function () {
                    if (this.value.length > 0) {
                        clearButton.style.display = 'flex';
                    } else {
                        clearButton.style.display = 'none';
                    }
                });

                // Clear search when button is clicked
                clearButton.addEventListener('click', function () {
                    searchInput.value = '';
                    clearButton.style.display = 'none';
                    searchInput.focus();
                    // Trigger HTMX to clear results
                    searchInput.dispatchEvent(new Event('keyup'));
                });
            }

            // Mobile menu functionality
            if (menuTrigger && sidebar && sidebarOverlay) {
                menuTrigger.addEventListener('click', function () {
                    sidebar.classList.add('cds-sidebar--open');
                    sidebarOverlay.classList.add('cds-sidebar-overlay--active');
                });

                sidebarOverlay.addEventListener('click', function () {
                    sidebar.classList.remove('cds-sidebar--open');
                    sidebarOverlay.classList.remove('cds-sidebar-overlay--active');
                });
            }
        });
    </script>
</body>

</html>